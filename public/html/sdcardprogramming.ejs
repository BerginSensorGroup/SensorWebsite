<!DOCTYPE html>
<!--[if lt IE 7 ]><html class="ie ie6" lang="en"> <![endif]-->
<!--[if IE 7 ]><html class="ie ie7" lang="en"> <![endif]-->
<!--[if IE 8 ]><html class="ie ie8" lang="en"> <![endif]-->
<!--[if (gte IE 9)|!(IE)]><!-->
<html lang="en">
<!--<![endif]-->

<head>

  <meta charset="utf-8">
  <meta http-equiv="X-UA-Compatible" content="IE=edge">
  <meta name="viewport" content="width=device-width, initial-scale=1, maximum-scale=1">
  <meta name="description" content="">
  <meta name="author" content="">
  <meta name="keywords" content="">

  <title>Low Cost Air Quality Sensors</title>

  <link rel="shortcut icon" href="images/favicon.ico" type="image/x-icon">

  <link rel="stylesheet" type="text/css" href="fonts/font-awesome-4.3.0/css/font-awesome.min.css">
  <link rel="stylesheet" type="text/css" href="css/stroke.css">
  <link rel="stylesheet" type="text/css" href="css/bootstrap.css">
  <link rel="stylesheet" type="text/css" href="css/animate.css">
  <link rel="stylesheet" type="text/css" href="css/prettyPhoto.css">
  <link rel="stylesheet" type="text/css" href="css/style.css">

  <link rel="stylesheet" type="text/css" href="js/syntax-highlighter/styles/shCore.css" media="all">
  <link rel="stylesheet" type="text/css" href="js/syntax-highlighter/styles/shThemeRDark.css" media="all">

  <!-- MATERIALIZE CSS -->
  <!-- <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/materialize/0.100.2/css/materialize.min.css"> -->

  <!-- CUSTOM -->
  <link rel="stylesheet" type="text/css" href="css/custom.css">

  <!-- HTML5 shim and Respond.js for IE8 support of HTML5 elements and media queries -->
  <!--[if lt IE 9]>
      <script src="https://oss.maxcdn.com/html5shiv/3.7.2/html5shiv.min.js"></script>
      <script src="https://oss.maxcdn.com/respond/1.4.2/respond.min.js"></script>
    <![endif]-->

</head>

<body>

  <div id="wrapper">

    <div class="container">

      <section id="top" class="section docs-heading">

        <div class="row">
          <div class="col-md-12">
            <div class="big-title text-center">
              <h1>Low-Cost Air Quality Monitoring Packages</h1>
              <p class="lead">Developed by Mike Bergin Lab at Duke University </p>
            </div>
            <!-- end title -->
          </div>
          <!-- end 12 -->

          <!-- Navigation Tabs at Top of Webpage-->
          <div id="navbar"></div>

        </div>
        <!-- end row -->

      </section>
      <!-- end section -->

      <div class="row">

        <div class="col-md-9">

          <section id="line1">

            <div class="row">
              <div class="col-md-12 left-align">
                <h2 class="dark-text">SD Card Programming<hr></h2>
              </div>
              <!-- end col -->
            </div>
            <!-- end row -->

            <ol type="I">
              <li>Label the SD cards so that you can tell which SD card belongs with which sensor package. You can either do this by writing directly on the SD card using permanent marker (I recommend silver for better visibility) or by attaching a tape label
                to the SD card, as we have done in Figure 3.</li>
              <li>
                <p>Upload the three files provided to the SD card (“CALI.txt”, “TEENSY.txt” and “LAB.txt”). Open all files. The first line in the “CALI.txt” file contains the box label, formatted as “BoxXX_XX_XX_XX”. You will need to change this box label
                  so that it reflects the sensors that are being used. After the box label, this file contains the electronic zero voltage and sensitivity constants from the Alphasense company that correspond to the individual Alphasense sensors, formatted
                  as “BoxNumber WEZeroNO AEZeroNO sensitivityNO WEZeroCO AEZeroCO sensitivityCO WEZeroNO2 AEZeroNO2 sensitivityNO2 WEZeroO3 AEZeroO3 auxNO2O3 sensitivityO3”. These numbers are from the Alphasense calibration data sheets. Here is a sample
                  “CALI.txt” file:</p>
                <p>Box01_51_01_00 Box51 300 300 0.500 300 300 0.500 299 303 0.249 375 403 0.323 0.334</p>
                <p> The box label numbers correspond to the Teensy, Alphasense, PM and CO2 sensors, respectively. When data are recorded to the SD card, this box label will be printed out in the header of the “TEENSY.txt” file. The Teensy number is identical
                  to the PM number, and should be written on the PM sensor fan. The Alphasense number is the last two digits found on the white tag on the green Alphasense circuit board (Figure 4). If you are not using Alphasense sensors in your package,
                  you will still need to include an Alphasense number in the box number (you can use “01”). This Alphasense number is used to specify which factory calibrations, included in the “CALI.txt” file, are applied to your raw Alphasense readings.
                  The CO2 number should be recorded on a piece of tape that you place on the Cozir CO2 sensor. If there is no CO2 sensor present, put “00” as the two-digit number. This labeling of the sensors allows us to keep track of sensor package
                  components that are causing problems, and to make sure any appropriate calibrations are applied.</p>

                <h4>Figure 4: The box label for this sensor would read "Box16_42_16_00”</h4>
                <img src="images/packages/sd-card-programming.png" alt="Figure 4:  The box label for this sensor would read Box16_42_16_00">

                <p>The “LAB.txt” file contains calibration constants calculated in the lab for the sensors. For example, if you run a chamber test and estimate a slope and intercept by comparing your sensor data to a Dustrak or other reference sensor, you
                  can include the calibration constants for that relationship here. Here is a sample “LAB.txt” file:</p>
                <p>NO 1 0
                  <br>NO2 1 0
                  <br>O3 1 0
                  <br>CO2 1 0
                  <br>TPM25 1 0
                  <br>PM25 1 0</p>
                <p>Each row is formatted as “Sensor m b” where m is the first order coefficient and b is the zeroth order coefficient. If you have not calibrated your sensors, leave these values as “1 0”, as shown above. </p>
                <p>NOTE: If both “CALI.txt” and “LAB.txt” files are not on the SD card, the sensor will not run and log data. If there is no Plantower sensor connected to your PCB, the package will not log data. However, if there are no gas sensors (Alphasense
                  and/or CO2), plugged in the package will continue to log data, although the values in the gas pollutant data columns are nonsensical and should be ignored. </p>
              </li>
              <li>
                <p>Once all three files are on the SD card, put the SD card back in the SD card reader in the sensor package.</p>
                <p>The “TEENSY.txt” file contains all of the data that have been logged to the SD card. All data are recorded in one file. Each time the teensy is powered on again (either by plugging the teensy itself in, or by connecting the package to
                  power using the barrel jack) a new header will be printed to the file. Following the header, minute-averaged (or whatever time frame you have specified in the teensy code) data will be recorded. The newest data are always added to the
                  bottom of the file. </p>
                <p>This is a sample header:</p>
                <p>Box01_34_01_04
                  <br>...New Logging Session...2016/7/11, 16:0:7, </p>
                <p>The next line in the text file labels all of the columns. This is a list of the columns: </p>
                <p>yyyy/mm/dd, hh:mm:ss, timeElapsed, TPM1, TPM2.5, TPM10, PM1, PM2.5, PM10, CO2, TempC, Humidity, NO, NO2, O3, CO2raw, workNO2, auxNO2, workO3, auxO3, labNO, labNO2, labO3, labCO2, labTPM25, labPM25</p>
                <p>The columns “yyyy/mm/dd” and “hh:mm:ss” hold the time stamps of the sensors, while “timeElapsed” represents the time elapsed from the beginning of the logging session in seconds. Each column with a pollutant name contains the readings
                  of that corresponding pollutant. The difference between the “TPM” and “PM” columns is that the “TPM” is PM values calibrated using TSI reference while the “PM” is PM values calibrated using atmospheric reference. The “work” and “aux”
                  values are readings from their corresponding Alphasense work and auxiliary pins, respectively. These values are used together to calculate the pollutant concentrations. The “lab” values are values calibrated using the calibration constants
                  obtained in lab. Every minute, averages of the data are written in a row to the SD card. This is a sample row of data:</p>
                <p>2016/7/11, 16:1:9, 64, 11, 16, 17, 11, 16, 17, 623.84, 23.82, 62.25, 29.13, 26.64, 34.13, 319.09, 92.55, 89.23, 132.26, 124.64, 29.13, 26.64, 34.13, 623.84, 16.00, 16.00</p>
              </li>
            </ol>

          </section>
          <!-- end section -->

          </section>
          <!-- end section -->
        </div>
        <!-- // end .col -->

      </div>
      <!-- // end .row -->

    </div>
    <!-- // end container -->

  </div>
  <!-- end wrapper -->

  <script src="js/jquery.min.js"></script>
  <script>
    $(function() {
      $("#navbar").load("html/navbar.ejs");
    });
  </script>
  <script src="js/bootstrap.min.js"></script>
  <script src="js/retina.js"></script>
  <script src="js/jquery.fitvids.js"></script>
  <script src="js/wow.js"></script>
  <script src="js/jquery.prettyPhoto.js"></script>

  <!-- CUSTOM PLUGINS -->
  <script src="js/custom.js"></script>
  <script src="js/main.js"></script>
  <script src="js/syntax-highlighter/scripts/shCore.js"></script>
  <script src="js/syntax-highlighter/scripts/shBrushXml.js"></script>
  <script src="js/syntax-highlighter/scripts/shBrushCss.js"></script>
  <script src="js/syntax-highlighter/scripts/shBrushJScript.js"></script>

</body>

</html>
